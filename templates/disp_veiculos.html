{% extends "base.html" %}
{% block content %}
<h1>Disponibilidade • Veículos</h1>
<p><b>Data de operação:</b> {{ data_ref.strftime("%d/%m/%Y") }}</p>

<form method="post" action="{{ url_for('disp_veiculos_salvar') }}">
  <input type="hidden" name="data_operacao" value="{{ data_ref.isoformat() }}">

  <table>
    <thead>
      <tr>
        <th>Base</th><th>Tipo</th><th>Placa</th><th>Modelo</th><th>Status</th><th>Liberação</th><th>Obs</th>
      </tr>
    </thead>
    <tbody>
      {% for v in veiculos %}
        {% set r = regs_map.get(v.id) %}
        <tr>
          <td>{{ v.base }}</td>
          <td>{{ v.tipo_rodado }}</td>
          <td>{{ v.placa }}</td>
          <td>{{ v.modelo or "" }}</td>

          <td>
            <input type="hidden" name="veiculo_id" value="{{ v.id }}">
            <select name="status">
              {% set val = (r.status if r else "Disponível") %}
              {% for s in ["Disponível","Manutenção","Quebrado","Documento","Uso Parcial"] %}
                <option {{ "selected" if s==val else "" }}>{{ s }}</option>
              {% endfor %}
            </select>
          </td>
          <td><input name="previsao_liberacao" value="{{ r.previsao_liberacao if r and r.previsao_liberacao else '' }}" placeholder="Ex: 10:00"></td>
          <td><input name="obs" value="{{ r.obs if r and r.obs else '' }}" placeholder="Observações"></td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <button type="submit">Salvar</button>
</form>
{% endblock %}
