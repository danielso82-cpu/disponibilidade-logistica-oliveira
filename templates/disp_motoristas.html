{% extends "base.html" %}
{% block content %}
<h1>Disponibilidade • Motoristas</h1>
<p><b>Data de operação:</b> {{ data_ref.strftime("%d/%m/%Y") }}</p>

<form method="post" action="{{ url_for('disp_motoristas_salvar') }}">
  <input type="hidden" name="data_operacao" value="{{ data_ref.isoformat() }}">

  <table>
    <thead>
      <tr>
        <th>Base</th><th>Motorista</th><th>Tipo Rodado</th><th>Status</th><th>Período</th><th>Obs</th>
      </tr>
    </thead>
    <tbody>
      {% for m in motoristas %}
        {% for t in tipos %}
          {% set r = regs_map.get((m.id, t)) %}
          <tr>
            <td>{{ m.base }}</td>
            <td>{{ m.nome }}</td>
            <td>
              {{ t }}
              <input type="hidden" name="motorista_id" value="{{ m.id }}">
              <input type="hidden" name="tipo_rodado" value="{{ t }}">
            </td>
            <td>
              <select name="status">
                {% set val = (r.status if r else "Disponível") %}
                {% for s in ["Disponível","Folga","Férias","Atestado","Falta","Restrição"] %}
                  <option {{ "selected" if s==val else "" }}>{{ s }}</option>
                {% endfor %}
              </select>
            </td>
            <td>
              <select name="periodo">
                {% set p = (r.periodo if r else "Integral") %}
                {% for s in ["Integral","Manhã","Tarde"] %}
                  <option {{ "selected" if s==p else "" }}>{{ s }}</option>
                {% endfor %}
              </select>
            </td>
            <td><input name="obs" value="{{ r.obs if r and r.obs else '' }}" placeholder="Observações"></td>
          </tr>
        {% endfor %}
      {% endfor %}
    </tbody>
  </table>

  <button type="submit">Salvar</button>
</form>
{% endblock %}
